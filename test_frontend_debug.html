<!DOCTYPE html>
<html>
<head>
    <title>Debug Frontend - Teste de Anexos</title>
    <style>
        body { font-family: Arial, sans-serif; margin: 20px; }
        .debug { background: #f0f0f0; padding: 10px; margin: 10px 0; border-radius: 5px; }
        .error { background: #ffe6e6; color: #d00; }
        .success { background: #e6ffe6; color: #080; }
        .info { background: #e6f3ff; color: #06c; }
    </style>
</head>
<body>
    <h1>游댌 Debug Frontend - Teste de Anexos</h1>
    
    <div class="debug info">
        <strong>Task ID:</strong> cme9z51cb00048udw760wr0tg<br>
        <strong>Objetivo:</strong> Verificar se o frontend est치 recebendo anexos da API
    </div>

    <h2>Resultados dos Testes:</h2>
    <div id="results"></div>

    <script>
        const taskId = 'cme9z51cb00048udw760wr0tg';
        const apiUrl = `http://localhost:3001/api/tasks/${taskId}`;
        const results = document.getElementById('results');

        function addResult(type, title, content) {
            const div = document.createElement('div');
            div.className = `debug ${type}`;
            div.innerHTML = `<strong>${title}:</strong><br>${content}`;
            results.appendChild(div);
        }

        async function testAPI() {
            try {
                addResult('info', 'Testando API', `Fazendo requisi칞칚o para: ${apiUrl}`);
                
                // Teste direto da API (vai falhar por autentica칞칚o, mas vamos ver)
                const response = await fetch(apiUrl, {
                    credentials: 'include', // Incluir cookies
                    headers: {
                        'Accept': 'application/json'
                    }
                });

                const data = await response.json();
                
                if (response.status === 401) {
                    addResult('error', 'Erro 401', 'API requer autentica칞칚o (esperado). Teste via browser neces치rio.');
                } else if (response.ok && data.success) {
                    const attachments = data.data.attachments || [];
                    addResult('success', 'API Funcionando', 
                        `Tarefa: ${data.data.description}<br>` +
                        `Anexos: ${attachments.length}<br>` +
                        attachments.map(a => `- ${a.name}`).join('<br>')
                    );
                } else {
                    addResult('error', 'Erro na API', JSON.stringify(data, null, 2));
                }
            } catch (error) {
                addResult('error', 'Erro de Rede', error.message);
            }
        }

        function testFrontend() {
            addResult('info', 'Instru칞칫es para Teste Frontend', `
                1. Abra http://localhost:3000/task/${taskId}<br>
                2. Abra Console (F12)<br>
                3. Procure por mensagens:<br>
                &nbsp;&nbsp;- 游꿢 Tarefa encontrada:<br>
                &nbsp;&nbsp;- 游늹 Anexos:<br>
                4. Verifique se anexos aparecem na tela
            `);
        }

        // Executar testes
        testAPI();
        testFrontend();

        // Teste adicional: verificar se frontend est치 rodando
        fetch('http://localhost:3000')
            .then(response => {
                if (response.ok) {
                    addResult('success', 'Frontend', 'Rodando em http://localhost:3000');
                } else {
                    addResult('error', 'Frontend', 'N칚o est치 respondendo');
                }
            })
            .catch(error => {
                addResult('error', 'Frontend', 'N칚o est치 rodando: ' + error.message);
            });
    </script>
</body>
</html>